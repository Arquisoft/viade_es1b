{"ast":null,"code":"import _objectSpread from \"c:\\\\Users\\\\alber\\\\Desktop\\\\ejemplo\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"c:\\\\Users\\\\alber\\\\Desktop\\\\ejemplo\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"c:\\\\Users\\\\alber\\\\Desktop\\\\ejemplo\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"c:\\\\Users\\\\alber\\\\Desktop\\\\ejemplo\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"c:\\\\Users\\\\alber\\\\Desktop\\\\ejemplo\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"c:\\\\Users\\\\alber\\\\Desktop\\\\ejemplo\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"c:\\\\Users\\\\alber\\\\Desktop\\\\ejemplo\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"c:\\\\Users\\\\alber\\\\Desktop\\\\ejemplo\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _taggedTemplateLiteral from \"c:\\\\Users\\\\alber\\\\Desktop\\\\ejemplo\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"c:\\\\Users\\\\alber\\\\Desktop\\\\ejemplo\\\\src\\\\components\\\\AuthNavBar\\\\children\\\\NavbarProfile\\\\nav-bar-profile.component.js\";\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  display: inline-block;\\n  margin-left: 10px;\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  background: #cccccc;\\n  display: block;\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  box-sizing: border-box;\\n  width: 100%;\\n  height: 100%;\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 42px;\\n  height: 42px;\\n  border-radius: 50%;\\n  background-size: cover;\\n  overflow: hidden;\\n  visibility: \", \";\\n  display: \", \";\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { Component } from 'react';\nimport styled from 'styled-components';\nimport { UpdateContext } from '@inrupt/solid-react-components';\nimport { Dropdown } from \"../../../Utils\";\nimport auth from 'solid-auth-client';\nimport data from '@solid/query-ldflex';\nimport { errorToaster } from \"../../../../utils\";\nimport { ProfileOptions } from \"../../../../constants/navigation\";\nexport var ImageContainer = styled.div(_templateObject(), function (_ref) {\n  var show = _ref.show;\n  return show ? 'visible' : 'hidden';\n}, function (_ref2) {\n  var show = _ref2.show;\n  return show ? 'block' : 'none';\n});\nexport var Img = styled.img(_templateObject2());\nexport var LoadingImage = styled(ImageContainer)(_templateObject3());\nexport var UserName = styled.span(_templateObject4());\nvar beforeContext;\n\nvar NavBarProfile = /*#__PURE__*/function (_Component) {\n  _inherits(NavBarProfile, _Component);\n\n  function NavBarProfile(props) {\n    var _this;\n\n    _classCallCheck(this, NavBarProfile);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NavBarProfile).call(this, props));\n    _this.state = {\n      imageLoaded: false\n    };\n\n    _this.profileRedirect = function () {\n      return _this.props.history.push('/profile');\n    };\n\n    _this.formModelRenderRedirect = function () {\n      return _this.props.history.push('/formModel/renderer');\n    };\n\n    _this.formModelConvertRedirect = function () {\n      return _this.props.history.push('/formModel/converter');\n    };\n\n    _this.onImageLoaded = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              return _context.abrupt(\"return\", _this.setState({\n                imageLoaded: true\n              }));\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    _this.logOut = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return auth.logout();\n\n            case 3:\n              // Remove localStorage\n              localStorage.removeItem('solid-auth-client'); // Redirect to login page\n\n              window.location = '/login';\n              _context2.next = 10;\n              break;\n\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](0);\n              errorToaster(_context2.t0.message, 'Error');\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 7]]);\n    }));\n    _this.getProfileData = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var user, userImage, defaultimage, image;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              // fetching user card from pod. This makes a request and returns the data\n              user = data.user;\n              /*\n               * In the background LDFlex is using JSON-LD. Because of this, we need to\n               * make an async call. This will return a JSON-LD expanded object and expose the requested value(name).\n               * for more information please go to: https://github.com/digitalbazaar/jsonld.js\n               */\n\n              _context3.next = 4;\n              return user.vcard_hasPhoto;\n\n            case 4:\n              userImage = _context3.sent;\n              defaultimage = _this.state.image;\n              image = userImage ? userImage.value : defaultimage;\n\n              _this.setState({\n                image: image\n              });\n\n              _context3.next = 13;\n              break;\n\n            case 10:\n              _context3.prev = 10;\n              _context3.t0 = _context3[\"catch\"](0);\n              errorToaster(_context3.t0.message, 'Error');\n\n            case 13:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[0, 10]]);\n    }));\n    _this.state = {\n      image: '/img/icon/empty-profile.svg'\n    };\n    return _this;\n  }\n\n  _createClass(NavBarProfile, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getProfileData();\n    }\n    /**\n     * Checks everytime the timestamp changes to go and fetch the data again\n     */\n\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var webId = this.props.webId;\n      if (webId && webId !== prevProps.webId) this.getProfileData();\n\n      if (this.context) {\n        var timestamp = this.context.timestamp;\n\n        if (timestamp !== beforeContext) {\n          this.getProfileData();\n          beforeContext = timestamp;\n        }\n      }\n    } // eslint-disable-next-line react/destructuring-assignment\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          t = _this$props.t,\n          open = _this$props.open,\n          customClass = _this$props.customClass;\n      var _this$state = this.state,\n          imageLoaded = _this$state.imageLoaded,\n          image = _this$state.image;\n      var profileOpts = ProfileOptions.map(function (item) {\n        return _objectSpread({}, item, {\n          label: t(item.label),\n          onClick: _this2[item.onClick]\n        });\n      });\n      return image ? React.createElement(Dropdown, {\n        actions: profileOpts,\n        className: \"nav-bar--profile \".concat(customClass),\n        open: open,\n        hover: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(ImageContainer, {\n        show: imageLoaded,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, React.createElement(Img, {\n        show: imageLoaded,\n        src: image,\n        alt: \"profile\",\n        onLoad: this.onImageLoaded,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      })), !imageLoaded && React.createElement(LoadingImage, {\n        show: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      })) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return NavBarProfile;\n}(Component);\n\nNavBarProfile.contextType = UpdateContext;\nexport default NavBarProfile;","map":{"version":3,"sources":["c:/Users/alber/Desktop/ejemplo/src/components/AuthNavBar/children/NavbarProfile/nav-bar-profile.component.js"],"names":["React","Component","styled","UpdateContext","Dropdown","auth","data","errorToaster","ProfileOptions","ImageContainer","div","show","Img","img","LoadingImage","UserName","span","beforeContext","NavBarProfile","props","state","imageLoaded","profileRedirect","history","push","formModelRenderRedirect","formModelConvertRedirect","onImageLoaded","setState","logOut","logout","localStorage","removeItem","window","location","message","getProfileData","user","vcard_hasPhoto","userImage","defaultimage","image","value","prevProps","webId","context","timestamp","t","open","customClass","profileOpts","map","item","label","onClick","contextType"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport styled from 'styled-components';\nimport { UpdateContext } from '@inrupt/solid-react-components';\nimport { Dropdown } from '@util-components';\n\nimport auth from 'solid-auth-client';\nimport data from '@solid/query-ldflex';\nimport { errorToaster } from '@utils';\nimport { ProfileOptions } from '@constants/navigation';\n\nexport const ImageContainer = styled.div`\n  width: 42px;\n  height: 42px;\n  border-radius: 50%;\n  background-size: cover;\n  overflow: hidden;\n  visibility: ${({ show }) => (show ? 'visible' : 'hidden')};\n  display: ${({ show }) => (show ? 'block' : 'none')};\n`;\n\nexport const Img = styled.img`\n  box-sizing: border-box;\n  width: 100%;\n  height: 100%;\n`;\n\nexport const LoadingImage = styled(ImageContainer)`\n  background: #cccccc;\n  display: block;\n`;\n\nexport const UserName = styled.span`\n  display: inline-block;\n  margin-left: 10px;\n`;\n\ntype Props = {\n  history: Object,\n  t: Function,\n  open: Boolean,\n  customClass: String,\n  webId: String\n};\n\nlet beforeContext;\n\nclass NavBarProfile extends Component<Props> {\n  constructor(props) {\n    super(props);\n    this.state = { image: '/img/icon/empty-profile.svg' };\n  }\n\n  state = {\n    imageLoaded: false\n  };\n\n  componentDidMount() {\n    this.getProfileData();\n  }\n\n  /**\n   * Checks everytime the timestamp changes to go and fetch the data again\n   */\n  componentDidUpdate(prevProps) {\n    const { webId } = this.props;\n    if (webId && webId !== prevProps.webId) this.getProfileData();\n    if (this.context) {\n      const { timestamp } = this.context;\n      if (timestamp !== beforeContext) {\n        this.getProfileData();\n        beforeContext = timestamp;\n      }\n    }\n  }\n\n  // eslint-disable-next-line react/destructuring-assignment\n  profileRedirect = () => this.props.history.push('/profile');\n\n  // eslint-disable-next-line react/destructuring-assignment\n  formModelRenderRedirect = () => this.props.history.push('/formModel/renderer');\n\n  // eslint-disable-next-line react/destructuring-assignment\n  formModelConvertRedirect = () => this.props.history.push('/formModel/converter');\n\n  onImageLoaded = async () => this.setState({ imageLoaded: true });\n\n  logOut = async () => {\n    try {\n      await auth.logout();\n      // Remove localStorage\n      localStorage.removeItem('solid-auth-client');\n      // Redirect to login page\n      window.location = '/login';\n    } catch (error) {\n      errorToaster(error.message, 'Error');\n    }\n  };\n\n  getProfileData = async () => {\n    try {\n      // fetching user card from pod. This makes a request and returns the data\n      const { user } = data;\n      /*\n       * In the background LDFlex is using JSON-LD. Because of this, we need to\n       * make an async call. This will return a JSON-LD expanded object and expose the requested value(name).\n       * for more information please go to: https://github.com/digitalbazaar/jsonld.js\n       */\n      const userImage = await user.vcard_hasPhoto;\n      const { image: defaultimage } = this.state;\n      const image = userImage ? userImage.value : defaultimage;\n      this.setState({ image });\n    } catch (error) {\n      errorToaster(error.message, 'Error');\n    }\n  };\n\n  render() {\n    const { t, open, customClass } = this.props;\n    const { imageLoaded, image } = this.state;\n\n    const profileOpts = ProfileOptions.map(item => ({\n      ...item,\n      label: t(item.label),\n      onClick: this[item.onClick]\n    }));\n\n    return image ? (\n      <Dropdown\n        actions={profileOpts}\n        className={`nav-bar--profile ${customClass}`}\n        open={open}\n        hover\n      >\n        <ImageContainer show={imageLoaded}>\n          <Img show={imageLoaded} src={image} alt=\"profile\" onLoad={this.onImageLoaded} />\n        </ImageContainer>\n        {!imageLoaded && <LoadingImage show />}\n      </Dropdown>\n    ) : (\n      <div />\n    );\n  }\n}\n\nNavBarProfile.contextType = UpdateContext;\n\nexport default NavBarProfile;\n"]},"metadata":{},"sourceType":"module"}